define("rvsui/app",["jquery","stapes","rvsui/route"],function(n,t,e){"use strict";return t.subclass({constructor:function(t,e){this.$el=t,this.options=n.extend({viewClass:"rvsui-view"},e),this._view=null,this._onLoad={}},route:function(n,t){var i=this;return e(n,function(){i.runView(t,arguments)}),this},run:function(){e.reload()},runView:function(t,e){var i=this;if(this._view){if(this._view.name===t)return void this._view.instantiate.run.apply(null,e);this._view.instantiate.destroy()}require([t],function(r){var s=n('<div class="'+i.options.viewClass+'"></div>'),o={name:t,instantiate:new r(s,i)};i.view=o,o.instantiate.run.apply(null,e),o.instantiate.$el.appendTo(i.$el)})}})}),define("rvsui/rivetsExt",["rivets"],function(n){"use strict";n.adapters[":"]={observe:function(n,t,e){n.on("change:"+t,e)},unobserve:function(n,t,e){n.off("change:"+t,e)},get:function(n,t){return n.get(t)},set:function(n,t,e){n.set(t,e)}},n.configure({handler:function(n,t,e){!1===this.call(e.view.models.self,n,t)&&(t.stopPropagation&&t.preventDefault?(t.stopPropagation(),t.preventDefault()):(window.event.cancelBubble=!0,window.event.returnValue=!1))}}),n.formatters.nl2br=function(n){return String(n||"").replace(/<[^>]+>/g,"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br/>$2")},n.formatters.link=function(n,t){return n?String(n)+t:""},n.formatters.has=function(n,t){return n?t:""}}),define("rvsui/route",[],function(){"use strict";return function(n){var t=[],e={},i=function(n,t){this.name=t,this.path=n,this.keys=[],this.fns=[],this.params={},this.regex=r(this.path,this.keys,!1,!1)};i.prototype.addHandler=function(n){this.fns.push(n)},i.prototype.removeHandler=function(n){for(var t=0,e=this.fns.length;e>t;t++){var i=this.fns[t];if(n==i)return void this.fns.splice(t,1)}},i.prototype.run=function(n){for(var t=0,e=this.fns.length;e>t;t++)this.fns[t].apply(this,n)},i.prototype.match=function(n,t){var e=this.regex.exec(n);if(!e)return!1;for(var i=1,r=e.length;r>i;++i){var s=this.keys[i-1],o="string"==typeof e[i]?decodeURIComponent(e[i]):e[i];s&&(this.params[s.name]=o),t.push(o)}return!0},i.prototype.toURL=function(n){var t=this.path;for(var e in n)t=t.replace("/:"+e,"/"+n[e]);if(t=t.replace(/\/:.*\?/g,"/").replace(/\?/g,""),-1!=t.indexOf(":"))throw new Error("missing parameters for url: "+t);return t};var r=function(n,t,e,i){return n instanceof RegExp?n:(n instanceof Array&&(n="("+n.join("|")+")"),n=n.concat(i?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(n,e,i,r,s,o){return t.push({name:r,optional:!!o}),e=e||"",""+(o?"":e)+"(?:"+(o?e:"")+(i||"")+(s||i&&"([^/.]+?)"||"([^/]+?)")+")"+(o||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+n+"$",e?"":"i"))},s=function(n,r){var s=n.split(" "),o=2==s.length?s[0]:null;n=2==s.length?s[1]:s[0],e[n]||(e[n]=new i(n,o),t.push(e[n])),e[n].addHandler(r)},o=function(n,t){if("function"==typeof t)s(n,t);else if("object"==typeof n)for(var e in n)s(e,n[e]);else"undefined"==typeof t&&o.navigate(n)};o.lookup=function(n,e){for(var i=0,r=t.length;r>i;i++){var s=t[i];if(s.name==n)return s.toURL(e)}},o.remove=function(n,t){var i=e[n];i&&i.removeHandler(t)},o.removeAll=function(){e={},t=[]},o.navigate=function(n,t){t=t||{};var e=t.silent||!1;e&&h(),setTimeout(function(){window.location.hash=n,e&&setTimeout(function(){f()},1)},1)};var u=function(){return window.location.hash.substring(1)},a=function(n,t){var e=[];return t.match(n,e)?(t.run(e),!0):!1},c=o.reload=function(){for(var n=u(),e=0,i=t.length;i>e;e++){var r=t[e];if(a(n,r))return}},f=function(){n.addEventListener?n.addEventListener("hashchange",c,!1):n.attachEvent("onhashchange",c)},h=function(){n.removeEventListener?n.removeEventListener("hashchange",c):n.detachEvent("onhashchange",c)};return f(),o}(window)}),define("rvsui/view",["jquery","stapes","rivets","rvsui/rivetsExt"],function(n,t,e){"use strict";var i=n("title");return t.subclass({constructor:function(n,t){this.$el=n,this.app=t,this._initTplUri=null,this.init()},init:function(){},run:function(){},watch:function(){},setTitle:function(n){i.text(n)},back:function(){return window.history.length>1?window.history.back():window.location.href="#",!1},destroy:function(){this.unbind(),this.$el.remove()},render:function(t,e){if(!e)return this.initTpl(t);var i=this,r=n.Deferred();return this.initTpl(t).done(function(){var t=Object.keys(e),s=[];t.forEach(function(n){s.push(e[n])}),i.when.apply(i,s).done(function(){var e=Array.prototype.slice.call(arguments);n.each(e,function(n,e){var r=t[n];r&&i.set(r,e)}),r.resolve()}).fail(function(){r.reject()})}).fail(function(){r.reject()}),r.promise()},initTpl:function(t){var e=n.Deferred(),i=this;return this._initTplUri===t?e.resolve(this.view):(null!==this._initTplUri&&this.unbind(),this.loadTpl(t).done(function(n){i.$el.html(n),e.resolve(i.bind()),i.watch()}).fail(function(){e.reject()})),e.promise()},loadTpl:function(t){var e=n.Deferred(),i=t.split("/");return 2===i.length&&require(["tpl/"+i[0]],function(n){var t=n[i[1]];e.resolve(t)}),e.promise()},bind:function(){return this.view?this.view:(this.view=e.bind(this.$el,{self:this}),this.view)},unbind:function(){this.view&&this.view.unbind(),this.$el.off()},when:function(){return n.when.apply(this,arguments)}})}),define("rvsui",["rvsui/app","rvsui/view"],function(n,t){"use strict";return{App:n,View:t}});