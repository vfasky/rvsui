define("rvsui/app",["jquery","stapes","rvsui/route"],function(t,e,i){"use strict";return e.subclass({constructor:function(e,i){this.$el=e,this.options=t.extend({viewClass:"rvsui-view"},i),this._view=null,this._onLoad={}},route:function(t,e){var n=this;return i(t,function(){n.runView(e,arguments)}),this},run:function(){i.reload()},runView:function(e,i){var n=this;if(this._view){if(this._view.name===e)return void this._view.instantiate.run.apply(this._view.instantiate,i);this._view.instantiate.destroy()}require([e],function(s){var r=t('<div class="'+n.options.viewClass+'"></div>'),a={name:e,instantiate:new s(r,n)};n._view=a,a.instantiate.run.apply(a.instantiate,i),a.instantiate.$el.appendTo(n.$el)})}})}),define("rvsui/checkbox",["jquery","rvsui/widgetBase","rvsui/toggle"],function(t,e){"use strict";var i=e.get("toggle");e.reg("checkbox",i.subclass({constructor:i.prototype.constructor,getClassName:function(){return"ui checkbox"}}))}),define("rvsui/rivetsExt",["rivets"],function(t){"use strict";t.adapters[":"]={observe:function(t,e,i){t.on("change:"+e,i)},unobserve:function(t,e,i){t.off("change:"+e,i)},get:function(t,e){return t.get(e)},set:function(t,e,i){t.set(e,i)}},t.configure({handler:function(t,e,i){!1===this.call(i.view.models.self,t,e)&&(e.stopPropagation&&e.preventDefault?(e.stopPropagation(),e.preventDefault()):(window.event.cancelBubble=!0,window.event.returnValue=!1))}}),t.formatters.nl2br=function(t){return String(t||"").replace(/<[^>]+>/g,"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br/>$2")},t.formatters.link=function(t,e){return t?String(t)+e:""},t.formatters.has=function(t,e){return t?e:""}}),define("rvsui/route",[],function(){"use strict";return function(t){var e=[],i={},n=function(t,e){this.name=e,this.path=t,this.keys=[],this.fns=[],this.params={},this.regex=s(this.path,this.keys,!1,!1)};n.prototype.addHandler=function(t){this.fns.push(t)},n.prototype.removeHandler=function(t){for(var e=0,i=this.fns.length;i>e;e++){var n=this.fns[e];if(t==n)return void this.fns.splice(e,1)}},n.prototype.run=function(t){for(var e=0,i=this.fns.length;i>e;e++)this.fns[e].apply(this,t)},n.prototype.match=function(t,e){var i=this.regex.exec(t);if(!i)return!1;for(var n=1,s=i.length;s>n;++n){var r=this.keys[n-1],a="string"==typeof i[n]?decodeURIComponent(i[n]):i[n];r&&(this.params[r.name]=a),e.push(a)}return!0},n.prototype.toURL=function(t){var e=this.path;for(var i in t)e=e.replace("/:"+i,"/"+t[i]);if(e=e.replace(/\/:.*\?/g,"/").replace(/\?/g,""),-1!=e.indexOf(":"))throw new Error("missing parameters for url: "+e);return e};var s=function(t,e,i,n){return t instanceof RegExp?t:(t instanceof Array&&(t="("+t.join("|")+")"),t=t.concat(n?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(t,i,n,s,r,a){return e.push({name:s,optional:!!a}),i=i||"",""+(a?"":i)+"(?:"+(a?i:"")+(n||"")+(r||n&&"([^/.]+?)"||"([^/]+?)")+")"+(a||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+t+"$",i?"":"i"))},r=function(t,s){var r=t.split(" "),a=2==r.length?r[0]:null;t=2==r.length?r[1]:r[0],i[t]||(i[t]=new n(t,a),e.push(i[t])),i[t].addHandler(s)},a=function(t,e){if("function"==typeof e)r(t,e);else if("object"==typeof t)for(var i in t)r(i,t[i]);else"undefined"==typeof e&&a.navigate(t)};a.lookup=function(t,i){for(var n=0,s=e.length;s>n;n++){var r=e[n];if(r.name==t)return r.toURL(i)}},a.remove=function(t,e){var n=i[t];n&&n.removeHandler(e)},a.removeAll=function(){i={},e=[]},a.navigate=function(t,e){e=e||{};var i=e.silent||!1;i&&h(),setTimeout(function(){window.location.hash=t,i&&setTimeout(function(){l()},1)},1)};var o=function(){return window.location.hash.substring(1)},u=function(t,e){var i=[];return e.match(t,i)?(e.run(i),!0):!1},c=a.reload=function(){for(var t=o(),i=0,n=e.length;n>i;i++){var s=e[i];if(u(t,s))return}},l=function(){t.addEventListener?t.addEventListener("hashchange",c,!1):t.attachEvent("onhashchange",c)},h=function(){t.removeEventListener?t.removeEventListener("hashchange",c):t.detachEvent("onhashchange",c)};return l(),a}(window)}),define("rvsui/select",["jquery","rvsui/widgetBase"],function(t,e){"use strict";var i=t(window);e.reg("select",e.subclass({constructor:e.prototype.constructor,init:function(){this.$soure.hide(),this.isStatic=void 0!==this.$soure.attr("data-static"),this.$el=t('<div class="ui selection dropdown" />'),this.$label=t('<div class="text" />').appendTo(this.$el),this.$el.append('<i class="dropdown icon" />'),this.$list=t('<div class="menu transition hidden" tabindex="-1" />').appendTo(this.$el),this.$label.text(this.$soure.attr("placeholder")||""),this.list=null,this.syncList(),this.$soure.data("proxyEl",this.$el),this.$el.insertAfter(this.$soure)},syncList:function(){var e=this;if(null===this.list||!1===this.isStatic){this.list=[],this.$list.find(".item").remove();var i="";this.$soure.find("option").each(function(){var n=t(this),s={value:n.val(),text:n.text()};i+='<div class="item" data-value="'+s.value+'">'+s.text+"</div>",e.list.push(s)}),this.$list.html(i)}return this.list},update:function(t){if(this.$soure.val(t),this.$list.find(".selected").attr("class","item"),t){var e=this.$list.find("[data-value="+t+"]").attr("class","item active selected");e.length>0&&this.$label.text(e.text())}},showList:function(){this.$el.attr("class","ui selection dropdown active visible"),this.$list.attr("class","menu transition visible")},hideList:function(){this.$el.attr("class","ui selection dropdown"),this.$list.attr("class","menu transition hidden")},watch:function(){var e=this;this.$el.on("click",function(){return e.showList(),e.syncList(),!1===e.isStatic&&e.update(e.getValue()),!1}).on("click",".item",function(){var i=t(this),n=i.attr("data-value");return e.sync(n),e.hideList(),e.$soure.trigger("change"),!1}),i.on("click.rvsuiSelect"+this.id,function(){e.hideList()})},destroy:function(){this.$el.remove(),i.off("click.rvsuiSelect"+this.id)}}))}),define("rvsui/toggle",["jquery","rvsui/widgetBase"],function(t,e){"use strict";e.reg("toggle",e.subclass({constructor:e.prototype.constructor,getClassName:function(){return"ui toggle checkbox"},init:function(){this.$soure.wrap('<div class="'+this.getClassName()+'"/>'),this.$el=this.$soure.parent(),this.$label=t("<label />"),this.$label.text(this.$soure.attr("title")||""),this.$label.appendTo(this.$el)},update:function(t){String(t)===String(this.$soure.val())?(this.$soure.prop("checked",!0),this.$el.attr("class",this.getClassName()+" checked")):(this.$soure.prop("checked",!1),this.$el.attr("class",this.getClassName()))},watch:function(){var t=this;this.$el.on("click",function(){return t.sync(t.$soure.prop("checked")?"":t.$soure.val()),t.$soure.trigger("change"),!1})}}))}),define("rvsui/validator",["jquery","rvsui/widgetBase"],function(t,e){"use strict";var i={},n=function(t,e){i[t]=e};return n("required",function(e,i){return i=i||"不能为空",-1!==["checkbox","radio"].indexOf(e.attr("type"))?{status:e.prop("checked"),msg:i}:{status:t.trim(e.val()).length>0,msg:i}}),n("minlength",function(e,i,n){n=n||"最小"+i+"位字符",i=Number(i);var s=t.trim(e.val());return{status:s.length>=i,msg:n}}),n("maxlength",function(e,i,n){n=n||"最多"+i+"位字符",i=Number(i);var s=t.trim(e.val());return{status:s.length<=i,msg:n}}),n("min",function(t,e,i){i=i||"数值要大于"+e,e=Number(e);var n=parseInt(t.val());return{status:n>=e,msg:i}}),n("max",function(t,e,i){i=i||"数值要小于"+e,e=Number(e);var n=parseInt(t.val());return{status:e>=n,msg:i}}),n("equals",function(t,e,i){return i=i||"两次输入的值不相符",{status:t.val()===e.val(),msg:i}}),n("isEmail",function(e,i){i=i||"邮箱格式不正确";var n=t.trim(e.val());return{status:0===n.length||/^(?:[a-z0-9]+[_\-+.]+)*[a-z0-9]+@(?:([a-z0-9]+-?)*[a-z0-9]+.)+([a-z]{2,})+$/i.test(n),msg:i}}),n("isDate",function(e,i){i=i||"日期格式不正确";var n=t.trim(e.val()),s=function(t){var e,i,n,s,r,a=/^([1-2]\d{3})([-/.])?(1[0-2]|0?[1-9])([-/.])?([1-2]\d|3[01]|0?[1-9])$/;return a.test(t)?(e=a.exec(t),n=+e[1],s=+e[3]-1,r=+e[5],i=new Date(n,s,r),n===i.getFullYear()&&s===i.getMonth()&&r===i.getDate()):!1};return{status:0===n.length||s(n),msg:i}}),n("isMobile",function(e,i){i=i||"手机格式不正确";var n=t.trim(e.val());return{status:0===n.length||/^1[3-9]\d{9}$/.test(n),msg:i}}),n("isTel",function(e,i){i=i||"座机格式不正确";var n=t.trim(e.val());return{status:0===n.length||/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/.test(n),msg:i}}),n("isUrl",function(e,i){i=i||"url 格式不正确";var n=function(){var t="((https?|s?ftp|irc[6s]?|git|afp|telnet|smb):\\/\\/)?",e="([a-z0-9]\\w*(\\:[\\S]+)?\\@)?",i="(?:localhost|(?:[a-z0-9]+(?:[-\\w]*[a-z0-9])?(?:\\.[a-z0-9][-\\w]*[a-z0-9])*)*\\.[a-z]{2,})",n="(:\\d{1,5})?",s="\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",r="(\\/\\S*)?",a=[t,e,i,n,r],o=[t,e,s,n,r],u=new RegExp("^"+a.join("")+"$","i"),c=new RegExp("^"+o.join("")+"$","i");return function(t){return u.test(t)||c.test(t)}}(),s=t.trim(e.val());return{status:0===s.length||n(s),msg:i}}),n("maxLength",i.maxlength),n("minLength",i.minlength),e.reg("validator",e.subclass({constructor:e.prototype.constructor,init:function(){var t=this;this.initRules(),this.$soure.data("check",function(){return t.check()}).data("initRules",function(){return t.initRules()})},initRules:function(){var e=this;this.rules=[],this.$validators=this.$soure.find("[validator]"),this.$validators.each(function(){e.parseValidator(t(this))})},watch:function(){var e=this;this.$soure.on("focus change","[validator]",function(){var i=t(this);e.hideError(i)}).on("click",".popup",function(){var e=t(this);return e.removeClass("visible").addClass("hidden"),e.data("soure").focus(),!1})},getData:function(){var t={};return this.$soure.serializeArray().forEach(function(e){t[e.name]=e.value}),t},check:function(){var e=!0,i=this;return t.each(this.rules,function(t,n){var s=n.rule.apply(null,n.args);return s.status!==!0?(e=!1,i.showError(n.args[0],s.msg),!1):void 0}),e?this.getData():!1},showError:function(t,e){var i=this.getErrorTip(t);i.html(e)},hideError:function(t){var e=t.data("tip");e&&e.removeClass("visible").addClass("hidden")},getErrorTip:function(e){var i=e.data("tip");i?i.addClass("visible").removeClass("hidden"):(i=t('<div class="ui red label popup transition bottom left visible" />'),i.appendTo(this.$soure),i.data("soure",e),e.data("tip",i));var n=e.data("proxyEl")||e,s=n.offset();return s.top+=(e.height()||20)+3,i.css(s),i},parseValidator:function(e){var n=this;e.attr("validator").split("|").forEach(function(s){var r=s.split(" ").filter(function(e){return t.trim(e).length>0}),a=i[r[0]],o=r[0];"equals"===o&&(r[1]=n.$soure.find(r[1])),r[0]=e,a?n.rules.push({rule:a,args:r}):console.log("validator rule: "+o+" undefined !")})}})),{add:n}}),define("rvsui/view",["jquery","stapes","rivets","rvsui/rivetsExt"],function(t,e,i){"use strict";var n=t("title");return e.subclass({constructor:function(t,e){this.$el=t,this.app=e,this.init()},init:function(){},run:function(){},watch:function(){},setTitle:function(t){n.text(t)},back:function(){return window.history.length>1?window.history.back():window.location.href="#",!1},destroy:function(){this.unbind(),this.$el.remove()},renderString:function(e,i){var n=t.Deferred(),s=this;i=i||{},this.view||(this.$el.html(e),this.bind(),this.watch());var r=Object.keys(i);if(0===r.length)n.resolve();else{var a=[];r.forEach(function(t){a.push(i[t])}),s.when.apply(s,a).done(function(){var e=Array.prototype.slice.call(arguments);t.each(e,function(t,e){var i=r[t];i&&s.set(i,e)}),n.resolve()}).fail(function(){n.reject()})}return n.promise()},render:function(e,i){var n=this,s=t.Deferred();return this.loadTpl(e).done(function(t){n.renderString(t,i).done(function(){s.resolve()}).fail(function(){s.reject()})}),s.promise()},loadTpl:function(e){var i=t.Deferred(),n=e.split("/");return 2===n.length&&require(["tpl/"+n[0]],function(t){var e=t[n[1]];i.resolve(e)}),i.promise()},bind:function(){return this.view?this.view:(this.view=i.bind(this.$el,{self:this}),this.view)},unbind:function(){this.view&&this.view.unbind(),this.$el.off()},when:function(){return t.when.apply(this,arguments)}})}),define("rvsui/widgetBase",["jquery","stapes","rivets"],function(t,e,i){"use strict";var n=0,s={},r=e.subclass({constructor:function(e,i){this.id=n++,this.view=i,this.$soure=t(e),this.init(),this.watch()},init:function(){},watch:function(){},getValue:function(){return this.$soure.val()},update:function(t){this.$soure.val(t)},destroy:function(){this.$soure.remove(),this.$el&&this.$el.remove()},sync:function(t){if(-1!==this.view.keypath.indexOf(":")){var e=this.view.keypath.split(":"),i=e[0],n=e.pop(),s=n.split(".").pop(),r=this.view.observer.obj[i];r&&this.view.model.set(s,t)}}});return r.reg=function(t,e){s[t]=e,i.binders[t]={bind:function(t){this.widget=new e(t,this)},unbind:function(){this.widget.destroy()},routine:function(t,e){this.widget.update(e||"",t)}}},r.get=function(t){return s[t]},r}),define("rvsui",["rvsui/app","rvsui/view","rvsui/select","rvsui/toggle","rvsui/checkbox","rvsui/validator"],function(t,e){"use strict";return{App:t,View:e}});