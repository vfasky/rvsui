define("rvsui/app",["jquery","stapes","rvsui/route"],function(t,e,i){"use strict";return e.subclass({constructor:function(e,i){this.$el=e,this.options=t.extend({viewClass:"rvsui-view"},i),this._view=null,this._onLoad={}},route:function(t,e){var s=this;return i(t,function(){s.runView(e,arguments)}),this},run:function(){i.reload()},runView:function(e,i){var s=this;if(this._view){if(this._view.name===e)return void this._view.instantiate.run.apply(this._view.instantiate,i);this._view.instantiate.destroy()}require([e],function(n){var r=t('<div class="'+s.options.viewClass+'"></div>'),a={name:e,instantiate:new n(r,s)};s._view=a,a.instantiate.run.apply(a.instantiate,i),a.instantiate.$el.appendTo(s.$el)})}})}),define("rvsui/checkbox",["jquery","rvsui/widgetBase","rvsui/toggle"],function(t,e){"use strict";var i=e.get("toggle");e.reg("checkbox",i.subclass({constructor:i.prototype.constructor,getClassName:function(){return"ui checkbox"}}))}),define("rvsui/loading",["jquery","rvsui/widgetBase"],function(t,e){"use strict";e.reg("loading",e.subclass({constructor:e.prototype.constructor,init:function(){this.$soure.addClass("ui"),this.$load=t('<div class="ui active inverted dimmer"><div class="ui active loader" /></div>').hide(),this.notClass=this.$soure.is(".segment")===!1,this.$load.appendTo(this.$soure)},update:function(t){t?this.show():this.hide()},show:function(){this.$load.show(),this.notClass&&this.$soure.addClass("segment")},hide:function(){this.$load.hide(),this.notClass&&this.$soure.removeClass("segment")}}))}),define("rvsui/progress",["jquery","rvsui/widgetBase"],function(t,e){"use strict";e.reg("progress",e.subclass({constructor:e.prototype.constructor,init:function(){this.$soure.addClass("ui indicating progress"),this.$val=t('<div class="bar"><div class="progress" /></div>'),this.$val.appendTo(this.$soure),this.$label=t('<div class="label" />').appendTo(this.$soure)},update:function(t){t=parseInt(t||"0"),t>100&&(t=100),t=String(t),this.$label.html(this.$soure.attr("title")||""),this.$val.css({width:t+"%"}).find(".progress").text(t+"%")}}))}),define("rvsui/rivetsExt",["rivets"],function(t){"use strict";t.adapters[":"]={observe:function(t,e,i){t.on("change:"+e,i)},unobserve:function(t,e,i){t.off("change:"+e,i)},get:function(t,e){return t.get(e)},set:function(t,e,i){t.set(e,i)}},t.configure({handler:function(t,e,i){!1===this.call(i.view.models.self,t,e)&&(e.stopPropagation&&e.preventDefault?(e.stopPropagation(),e.preventDefault()):(window.event.cancelBubble=!0,window.event.returnValue=!1))}}),t.formatters.nl2br=function(t){return String(t||"").replace(/<[^>]+>/g,"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br/>$2")},t.formatters.link=function(t,e){return t?String(t)+e:""},t.formatters.has=function(t,e){return t?e:""}}),define("rvsui/route",[],function(){"use strict";return function(t){var e=[],i={},s=function(t,e){this.name=e,this.path=t,this.keys=[],this.fns=[],this.params={},this.regex=n(this.path,this.keys,!1,!1)};s.prototype.addHandler=function(t){this.fns.push(t)},s.prototype.removeHandler=function(t){for(var e=0,i=this.fns.length;i>e;e++){var s=this.fns[e];if(t==s)return void this.fns.splice(e,1)}},s.prototype.run=function(t){for(var e=0,i=this.fns.length;i>e;e++)this.fns[e].apply(this,t)},s.prototype.match=function(t,e){var i=this.regex.exec(t);if(!i)return!1;for(var s=1,n=i.length;n>s;++s){var r=this.keys[s-1],a="string"==typeof i[s]?decodeURIComponent(i[s]):i[s];r&&(this.params[r.name]=a),e.push(a)}return!0},s.prototype.toURL=function(t){var e=this.path;for(var i in t)e=e.replace("/:"+i,"/"+t[i]);if(e=e.replace(/\/:.*\?/g,"/").replace(/\?/g,""),-1!=e.indexOf(":"))throw new Error("missing parameters for url: "+e);return e};var n=function(t,e,i,s){return t instanceof RegExp?t:(t instanceof Array&&(t="("+t.join("|")+")"),t=t.concat(s?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(t,i,s,n,r,a){return e.push({name:n,optional:!!a}),i=i||"",""+(a?"":i)+"(?:"+(a?i:"")+(s||"")+(r||s&&"([^/.]+?)"||"([^/]+?)")+")"+(a||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+t+"$",i?"":"i"))},r=function(t,n){var r=t.split(" "),a=2==r.length?r[0]:null;t=2==r.length?r[1]:r[0],i[t]||(i[t]=new s(t,a),e.push(i[t])),i[t].addHandler(n)},a=function(t,e){if("function"==typeof e)r(t,e);else if("object"==typeof t)for(var i in t)r(i,t[i]);else"undefined"==typeof e&&a.navigate(t)};a.lookup=function(t,i){for(var s=0,n=e.length;n>s;s++){var r=e[s];if(r.name==t)return r.toURL(i)}},a.remove=function(t,e){var s=i[t];s&&s.removeHandler(e)},a.removeAll=function(){i={},e=[]},a.navigate=function(t,e){e=e||{};var i=e.silent||!1;i&&l(),setTimeout(function(){window.location.hash=t,i&&setTimeout(function(){c()},1)},1)};var o=function(){return window.location.hash.substring(1)},u=function(t,e){var i=[];return e.match(t,i)?(e.run(i),!0):!1},h=a.reload=function(){for(var t=o(),i=0,s=e.length;s>i;i++){var n=e[i];if(u(t,n))return}},c=function(){t.addEventListener?t.addEventListener("hashchange",h,!1):t.attachEvent("onhashchange",h)},l=function(){t.removeEventListener?t.removeEventListener("hashchange",h):t.detachEvent("onhashchange",h)};return c(),a}(window)}),define("rvsui/select",["jquery","rvsui/widgetBase"],function(t,e){"use strict";var i=t(window);e.reg("select",e.subclass({constructor:e.prototype.constructor,init:function(){this.$soure.hide(),this.isStatic=void 0!==this.$soure.attr("data-static"),this.$el=t('<div class="ui selection dropdown" />'),this.$label=t('<div class="text" />').appendTo(this.$el),this.$el.append('<i class="dropdown icon" />'),this.$list=t('<div class="menu transition hidden" tabindex="-1" />').appendTo(this.$el),this.$label.text(this.$soure.attr("title")||this.$soure.attr("placeholder")||""),this.list=null,this.syncList(),this.$soure.data("proxyEl",this.$el),this.$el.insertAfter(this.$soure)},syncList:function(){var e=this;if(null===this.list||!1===this.isStatic){this.list=[],this.$list.find(".item").remove();var i="";this.$soure.find("option").each(function(){var s=t(this),n={value:s.val(),text:s.text()};i+='<div class="item" data-value="'+n.value+'">'+n.text+"</div>",e.list.push(n)}),this.$list.html(i)}return this.list},update:function(t){if(this.$soure.val(t),this.$list.find(".selected").attr("class","item"),t){var e=this.$list.find("[data-value="+t+"]").attr("class","item active selected");e.length>0&&this.$label.text(e.text())}},showList:function(){this.$el.attr("class","ui selection dropdown active visible"),this.$list.attr("class","menu transition visible")},hideList:function(){this.$el.attr("class","ui selection dropdown"),this.$list.attr("class","menu transition hidden")},watch:function(){var e=this;this.$el.on("click",function(){return e.showList(),e.syncList(),!1===e.isStatic&&e.update(e.getValue()),!1}).on("click",".item",function(){var i=t(this),s=i.attr("data-value");return e.sync(s),e.hideList(),e.$soure.trigger("change"),!1}),i.on("click.rvsuiSelect"+this.id,function(){e.hideList()})},destroy:function(){this.$el.remove(),i.off("click.rvsuiSelect"+this.id)}}))}),function(){function t(t,i,s,n){return new e(t,i,s,n)}function e(t,e,s,n){this.options=n||{},this.options.adapters=this.options.adapters||{},this.obj=t,this.keypath=e,this.callback=s,this.objectPath=[],this.parse(),i(this.target=this.realize())&&this.set(!0,this.key,this.target,this.callback)}function i(t){return"object"==typeof t&&null!==t}function s(t){throw new Error("[sightglass] "+t)}t.adapters={},e.tokenize=function(t,e,i){var s,n,r=[],a={i:i,path:""};for(s=0;s<t.length;s++)n=t.charAt(s),~e.indexOf(n)?(r.push(a),a={i:n,path:""}):a.path+=n;return r.push(a),r},e.prototype.parse=function(){var i,n,r=this.interfaces();r.length||s("Must define at least one adapter interface."),~r.indexOf(this.keypath[0])?(i=this.keypath[0],n=this.keypath.substr(1)):("undefined"==typeof(i=this.options.root||t.root)&&s("Must define a default root adapter."),n=this.keypath),this.tokens=e.tokenize(n,r,i),this.key=this.tokens.pop()},e.prototype.realize=function(){var t,e=this.obj,s=!1;return this.tokens.forEach(function(n,r){i(e)?("undefined"!=typeof this.objectPath[r]?e!==(t=this.objectPath[r])&&(this.set(!1,n,t,this.update.bind(this)),this.set(!0,n,e,this.update.bind(this)),this.objectPath[r]=e):(this.set(!0,n,e,this.update.bind(this)),this.objectPath[r]=e),e=this.get(n,e)):(s===!1&&(s=r),(t=this.objectPath[r])&&this.set(!1,n,t,this.update.bind(this)))},this),s!==!1&&this.objectPath.splice(s),e},e.prototype.update=function(){var t,e;(t=this.realize())!==this.target&&(i(this.target)&&this.set(!1,this.key,this.target,this.callback),i(t)&&this.set(!0,this.key,t,this.callback),e=this.value(),this.target=t,this.value()!==e&&this.callback())},e.prototype.value=function(){return i(this.target)?this.get(this.key,this.target):void 0},e.prototype.setValue=function(t){i(this.target)&&this.adapter(this.key).set(this.target,this.key.path,t)},e.prototype.get=function(t,e){return this.adapter(t).get(e,t.path)},e.prototype.set=function(t,e,i,s){var n=t?"observe":"unobserve";this.adapter(e)[n](i,e.path,s)},e.prototype.interfaces=function(){var e=Object.keys(this.options.adapters);return Object.keys(t.adapters).forEach(function(t){~e.indexOf(t)||e.push(t)}),e},e.prototype.adapter=function(e){return this.options.adapters[e.i]||t.adapters[e.i]},e.prototype.unobserve=function(){var t;this.tokens.forEach(function(e,i){(t=this.objectPath[i])&&this.set(!1,e,t,this.update.bind(this))},this),i(this.target)&&this.set(!1,this.key,this.target,this.callback)},"undefined"!=typeof module&&module.exports?module.exports=t:"function"==typeof define&&define.amd?define("sightglass",[],function(){return this.sightglass=t}):this.sightglass=t}.call(this),define("rvsui/toggle",["jquery","rvsui/widgetBase"],function(t,e){"use strict";e.reg("toggle",e.subclass({constructor:e.prototype.constructor,getClassName:function(){return"ui toggle checkbox"},init:function(){this.$soure.wrap('<div class="'+this.getClassName()+'"/>'),this.$el=this.$soure.parent(),this.$label=t("<label />"),this.$label.text(this.$soure.attr("title")||""),this.$label.appendTo(this.$el)},update:function(t){String(t)===String(this.$soure.val())?(this.$soure.prop("checked",!0),this.$el.attr("class",this.getClassName()+" checked")):(this.$soure.prop("checked",!1),this.$el.attr("class",this.getClassName()))},watch:function(){var t=this;this.$el.on("click",function(){return t.sync(t.$soure.prop("checked")?"":t.$soure.val()),t.$soure.trigger("change"),!1})}}))}),define("rvsui/validator",["jquery","rvsui/widgetBase"],function(t,e){"use strict";var i={},s=function(t,e){i[t]=e};return s("required",function(e,i){return i=i||"不能为空",-1!==["checkbox","radio"].indexOf(e.attr("type"))?{status:e.prop("checked"),msg:i}:{status:t.trim(e.val()).length>0,msg:i}}),s("minlength",function(e,i,s){s=s||"最小"+i+"位字符",i=Number(i);var n=t.trim(e.val());return{status:n.length>=i,msg:s}}),s("maxlength",function(e,i,s){s=s||"最多"+i+"位字符",i=Number(i);var n=t.trim(e.val());return{status:n.length<=i,msg:s}}),s("min",function(t,e,i){i=i||"数值要大于"+e,e=Number(e);var s=parseInt(t.val());return{status:s>=e,msg:i}}),s("max",function(t,e,i){i=i||"数值要小于"+e,e=Number(e);var s=parseInt(t.val());return{status:e>=s,msg:i}}),s("equals",function(t,e,i){return i=i||"两次输入的值不相符",{status:t.val()===e.val(),msg:i}}),s("isEmail",function(e,i){i=i||"邮箱格式不正确";var s=t.trim(e.val());return{status:0===s.length||/^(?:[a-z0-9]+[_\-+.]+)*[a-z0-9]+@(?:([a-z0-9]+-?)*[a-z0-9]+.)+([a-z]{2,})+$/i.test(s),msg:i}}),s("isDate",function(e,i){i=i||"日期格式不正确";var s=t.trim(e.val()),n=function(t){var e,i,s,n,r,a=/^([1-2]\d{3})([-/.])?(1[0-2]|0?[1-9])([-/.])?([1-2]\d|3[01]|0?[1-9])$/;return a.test(t)?(e=a.exec(t),s=+e[1],n=+e[3]-1,r=+e[5],i=new Date(s,n,r),s===i.getFullYear()&&n===i.getMonth()&&r===i.getDate()):!1};return{status:0===s.length||n(s),msg:i}}),s("isMobile",function(e,i){i=i||"手机格式不正确";var s=t.trim(e.val());return{status:0===s.length||/^1[3-9]\d{9}$/.test(s),msg:i}}),s("isTel",function(e,i){i=i||"座机格式不正确";var s=t.trim(e.val());return{status:0===s.length||/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/.test(s),msg:i}}),s("isUrl",function(e,i){i=i||"url 格式不正确";var s=function(){var t="((https?|s?ftp|irc[6s]?|git|afp|telnet|smb):\\/\\/)?",e="([a-z0-9]\\w*(\\:[\\S]+)?\\@)?",i="(?:localhost|(?:[a-z0-9]+(?:[-\\w]*[a-z0-9])?(?:\\.[a-z0-9][-\\w]*[a-z0-9])*)*\\.[a-z]{2,})",s="(:\\d{1,5})?",n="\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",r="(\\/\\S*)?",a=[t,e,i,s,r],o=[t,e,n,s,r],u=new RegExp("^"+a.join("")+"$","i"),h=new RegExp("^"+o.join("")+"$","i");return function(t){return u.test(t)||h.test(t)}}(),n=t.trim(e.val());return{status:0===n.length||s(n),msg:i}}),s("maxLength",i.maxlength),s("minLength",i.minlength),e.reg("validator",e.subclass({constructor:e.prototype.constructor,init:function(){var t=this;this.$soure.addClass("ui"),this.initLoading(),this.initRules(),this.$soure.data("check",function(){return t.check()}).data("initRules",function(){return t.initRules()}).data("loading",t.loading)},initLoading:function(){var e=this;this.$load=t('<div class="ui active inverted dimmer"><div class="ui active loader" /></div>').hide(),this.$load.appendTo(this.$soure),this.loading={show:function(){e.$load.show(),e.$soure.addClass("segment")},hide:function(){e.$load.hide(),e.$soure.removeClass("segment")}}},initRules:function(){var e=this;this.rules=[],this.$validators=this.$soure.find("[validator]"),this.$validators.each(function(){e.parseValidator(t(this))})},watch:function(){var e=this;this.$soure.on("focus change","[validator]",function(){var i=t(this);e.hideError(i)}).on("click",".popup",function(){var e=t(this);return e.removeClass("visible").addClass("hidden"),e.data("soure").focus(),!1})},getData:function(){var t={};return this.$soure.serializeArray().forEach(function(e){t[e.name]=e.value}),t},check:function(){var e=!0,i=this;return this.loading.show(),t.each(this.rules,function(t,s){var n=s.rule.apply(null,s.args);return n.status!==!0?(e=!1,i.showError(s.args[0],n.msg),i.loading.hide(),!1):void 0}),e?this.getData():!1},showError:function(t,e){var i=this.getErrorTip(t);i.html(e)},hideError:function(t){var e=t.data("tip");e&&e.removeClass("visible").addClass("hidden")},getErrorTip:function(e){var i=e.data("tip");i?i.addClass("visible").removeClass("hidden"):(i=t('<div class="ui red label popup transition bottom left visible" />'),i.appendTo(this.$soure),i.data("soure",e),e.data("tip",i));var s=e.data("proxyEl")||e,n=s.offset();return n.top+=(e.height()||20)+3,i.css(n),i},parseValidator:function(e){var s=this;e.attr("validator").split("|").forEach(function(n){var r=n.split(" ").filter(function(e){return t.trim(e).length>0}),a=i[r[0]],o=r[0];"equals"===o&&(r[1]=s.$soure.find(r[1])),r[0]=e,a?s.rules.push({rule:a,args:r}):console.log("validator rule: "+o+" undefined !")})}})),{add:s}}),define("rvsui/view",["jquery","stapes","rivets","rvsui/rivetsExt"],function(t,e,i){"use strict";var s=t("title");return e.subclass({constructor:function(t,e){this.$el=t,this.app=e,this.init()},init:function(){},run:function(){},watch:function(){},setTitle:function(t){s.text(t)},back:function(){return window.history.length>1?window.history.back():window.location.href="#",!1},destroy:function(){this.unbind(),this.$el.remove()},renderString:function(e,i){var s=t.Deferred(),n=this;i=i||{},this.view||(this.$el.html(e),this.bind(),this.watch());var r=Object.keys(i);if(0===r.length)s.resolve();else{var a=[];r.forEach(function(t){a.push(i[t])}),n.when.apply(n,a).done(function(){var e=Array.prototype.slice.call(arguments);t.each(e,function(t,e){var i=r[t];i&&n.set(i,e)}),s.resolve()}).fail(function(){s.reject()})}return s.promise()},render:function(e,i){var s=this,n=t.Deferred();return this.loadTpl(e).done(function(t){s.renderString(t,i).done(function(){n.resolve()}).fail(function(){n.reject()})}),n.promise()},loadTpl:function(e){var i=t.Deferred(),s=e.split("/");return 2===s.length&&require(["tpl/"+s[0]],function(t){var e=t[s[1]];i.resolve(e)}),i.promise()},bind:function(){return this.view?this.view:(this.view=i.bind(this.$el,{self:this}),this.view)},unbind:function(){this.view&&this.view.unbind(),this.$el.off()},when:function(){return t.when.apply(this,arguments)}})}),define("rvsui/widgetBase",["jquery","stapes","rivets"],function(t,e,i){"use strict";var s=0,n={},r=e.subclass({constructor:function(e,i){this.id=s++,this.view=i,this.$soure=t(e),this.init(),this.watch()},init:function(){},watch:function(){},getValue:function(){return this.$soure.val()},update:function(t){this.$soure.val(t)},destroy:function(){this.$soure.remove(),this.$el&&this.$el.remove()},sync:function(t){if(-1!==this.view.keypath.indexOf(":")){var e=this.view.keypath.split(":"),i=e[0],s=e.pop(),n=s.split(".").pop(),r=this.view.observer.obj[i];r&&this.view.model.set(n,t)}}});return r.reg=function(t,e){n[t]=e,i.binders[t]={bind:function(t){this.widget=new e(t,this)},unbind:function(){this.widget.destroy()},routine:function(t,e){this.widget.update(e||"",t)}}},r.get=function(t){return n[t]},r}),define("rvsui",["rvsui/app","rvsui/view","rvsui/select","rvsui/toggle","rvsui/checkbox","rvsui/validator","rvsui/loading","rvsui/progress"],function(t,e){"use strict";return{App:t,View:e}});